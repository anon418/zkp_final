# 📖 VoteZK 사용자 가이드

> **ZKP 기반 익명 투표 플랫폼**  
> 익명성과 투명성을 동시에 보장하는 투표 시스템

---

## 📋 목차

1. [시작하기](#시작하기)
2. [투표 생성하기](#투표-생성하기)
3. [투표 참여하기](#투표-참여하기)
4. [결과 확인하기](#결과-확인하기)
5. [통계 보기](#통계-보기)
6. [FAQ](#faq)

---

## 시작하기

### 필수 요구사항

- **MetaMask 지갑**: 브라우저 확장 프로그램 설치 필요
- **Sepolia 테스트넷**: MetaMask에서 Sepolia 네트워크 연결
- **Sepolia ETH**: 투표 생성 시 필요 (Relayer 사용 시 불필요)

### MetaMask 설정

1. **MetaMask 설치**

   - [MetaMask 공식 사이트](https://metamask.io/)에서 설치
   - 브라우저 확장 프로그램으로 추가

2. **Sepolia 네트워크 추가**

   - MetaMask → 네트워크 선택 → "네트워크 추가"
   - Sepolia Testnet 선택 또는 수동 추가:
     - 네트워크 이름: `Sepolia`
     - RPC URL: `https://sepolia.infura.io/v3/YOUR_KEY`
     - 체인 ID: `11155111`
     - 통화 기호: `ETH`

3. **Sepolia ETH 받기**
   - [Sepolia Faucet](https://sepoliafaucet.com/)에서 무료 ETH 받기
   - 투표 생성 시 필요 (Relayer 사용 시 불필요)

---

## 투표 생성하기

### 1단계: 투표 생성 페이지 접속

1. 메인 페이지에서 **"투표 만들기"** 버튼 클릭
2. 또는 직접 `/vote/new` 경로로 접속

### 2단계: MetaMask 연결

1. **"MetaMask 연결"** 버튼 클릭
2. MetaMask 팝업에서 **"연결"** 클릭
3. Sepolia 네트워크가 아닌 경우 자동으로 전환 요청

### 3단계: 투표 정보 입력

#### 기본 정보

- **투표 제목** (필수)
  - 최대 200자
  - 예: "2025년 학과 회장 선거"
- **투표 설명** (선택)
  - 최대 1000자
  - 투표 목적, 규칙, 주의사항 등

#### 후보 입력

- **후보 추가**: "후보 추가" 버튼 클릭
- **후보 수**: 최소 2개, 최대 10개
- **후보 이름**: 각 후보의 이름 또는 옵션 입력
- **후보 삭제**: 각 후보 옆 "삭제" 버튼 클릭

#### 템플릿 사용 (선택)

- **"템플릿 사용"** 토글 활성화
- 제공되는 템플릿:
  - 학과 회장 선거
  - 동아리 회장 선거
  - 프로젝트 주제 선택
  - 기타

템플릿 사용 시 후보가 자동으로 입력되며, 수정 가능합니다.

#### 마감 시간 설정

두 가지 방법 중 선택:

**방법 1: 시간으로 설정**

- 시간 입력 (예: 24시간)
- 최소: 0.17시간 (10분)
- 최대: 720시간 (30일)
- 소수점 지원 (예: 0.5시간 = 30분)

**방법 2: 날짜로 설정**

- 달력 아이콘 클릭
- 년/월/일/시/분 선택
- 최소: 현재 시간 + 10분
- 최대: 현재 시간 + 30일

### 4단계: 투표 생성

1. **"투표 생성하기"** 버튼 클릭
2. MetaMask 트랜잭션 확인 (온체인 생성 시)
3. 생성 완료 후 **QR 코드** 자동 표시
4. **pollId** 복사 또는 QR 코드 공유

### 5단계: 투표 공유

- **QR 코드**: 모바일로 스캔하여 접속
- **링크 복사**: URL을 복사하여 공유
- **"내 투표 목록"**: 생성한 투표 관리

---

## 투표 참여하기

### 1단계: 투표 페이지 접속

- **QR 코드 스캔**: 모바일 카메라로 스캔
- **링크 접속**: 공유받은 URL 클릭
- **경로**: `/vote/[pollId]`

### 2단계: 투표 정보 확인

- **투표 제목 및 설명** 확인
- **후보 목록** 확인
- **마감 시간** 확인 (실시간 카운트다운)
- **참여자 수** 확인 (실시간 업데이트)

### 3단계: MetaMask 연결

1. **"MetaMask 연결"** 버튼 클릭
2. MetaMask 팝업에서 **"연결"** 클릭
3. Sepolia 네트워크 확인

### 4단계: 후보 선택

- 원하는 후보 클릭
- 선택된 후보는 강조 표시
- 다른 후보 클릭 시 선택 변경 가능

### 5단계: ZKP 증명 생성

1. **"Generate Proof"** 버튼 클릭
2. **진행 상황 표시**:
   - "증명 생성 중..." (약 15초)
   - 진행률 표시
   - 타임아웃: 120초

**중요**:

- 이 과정에서 **Zero-Knowledge Proof**가 생성됩니다
- 투표 내용은 암호화되어 서버도 알 수 없습니다
- 증명 생성 중에는 페이지를 닫지 마세요

### 6단계: 투표 제출

1. 증명 생성 완료 후 **"Submit"** 버튼 클릭
2. **Relayer 사용** (기본값):
   - 가스비 자동 대납
   - 사용자는 가스비 지불 불필요
3. **트랜잭션 확인**:
   - "블록체인에 투표 전송 중..." 표시
   - 2회 컨펌 대기 (약 1-2분)
4. **완료 안내**:
   - "✅ 투표 완료!" 메시지
   - Etherscan 링크 제공

### 7단계: 투표 확인

- **Etherscan 링크**: 블록체인에서 투표 확인
- **ZKP Public Signals**: 증명 가능한 정보 표시
  - Merkle Root (유권자 목록 증명)
  - Poll ID
  - Nullifier (중복 방지 증명)
  - Vote Commitment (투표 암호화)

---

## 결과 확인하기

### 투표 상세 페이지에서 확인

1. 투표 페이지 하단의 **"📊 결과 보기"** 버튼 클릭
2. 또는 마감 시간이 지나면 자동으로 결과 표시

### 결과 정보

- **후보별 득표수**: 각 후보가 받은 표 수
- **득표율**: 백분율로 표시
- **진행 바**: 시각적 표현
- **1위 표시**: 가장 많은 표를 받은 후보 강조
- **총 참여자 수**: 전체 투표 참여 인원

### 실시간 업데이트

- **진행 중 투표**: 10초마다 자동 갱신
- **종료된 투표**: 결과 고정

### CSV 내보내기

1. 투표 상세 페이지에서 **"CSV 내보내기"** 버튼 클릭
2. 다운로드된 CSV 파일 열기
3. 포함 정보:
   - 투표 제목 및 설명
   - 상태 (진행 중/종료됨)
   - 생성일, 시작 시간, 종료 시간
   - 내보내기 시각
   - 후보별 득표수 및 득표율

---

## 통계 보기

### 통계 페이지 접속

- 메인 페이지에서 **"통계 보기"** 버튼 클릭
- 또는 직접 `/stats` 경로로 접속

### 통계 정보

#### 전체 통계

- **전체 투표 수**: 생성된 모든 투표
- **전체 참여 수**: 모든 투표의 총 참여자 수
- **진행 중 투표**: 현재 진행 중인 투표 수
- **종료된 투표**: 마감된 투표 수
- **오늘 생성된 투표**: 오늘 생성된 투표 수
- **오늘 참여 수**: 오늘 투표에 참여한 인원 수

#### 인기 투표 Top 5

- **하이브리드 표시**:
  - 각 투표의 제목 표시
  - 상위 3개 후보의 득표수 및 득표율 표시
  - "+N개 후보 더보기" 표시 (4개 이상인 경우)
- **상세 보기**: 각 투표 카드 클릭 시 상세 페이지로 이동

---

## 투표 관리

### 내 투표 목록

1. **"내 투표 목록"** 링크 클릭
2. 또는 `/vote` 경로로 접속
3. MetaMask 연결 필요

### 투표 목록 정보

각 투표 카드에 표시되는 정보:

- **투표 제목**
- **상태 배지**:
  - 🟢 **진행 중**: 현재 투표 가능
  - 🔴 **종료됨**: 마감 시간 경과
  - 🟡 **대기 중**: 시작 시간 전
- **생성일 및 시간**: 투표 생성 시각
- **마감일 및 시간**: 투표 마감 시각
- **참여자 수**: 현재까지 참여한 인원

### 투표 삭제

1. 투표 목록에서 삭제할 투표 찾기
2. **"삭제"** 버튼 클릭
3. 확인 메시지에서 **"확인"** 클릭
4. **주의**:
   - 삭제된 투표는 복구 불가능
   - 투표와 모든 투표 데이터가 영구 삭제
   - 생성자만 삭제 가능

---

## 재투표 정책

### 재투표 가능

- **마감 시간 전까지** 재투표 가능
- 같은 지갑 주소로 여러 번 투표 가능
- **마지막 투표만 유효**: 이전 투표는 자동으로 무효화

### 재투표 방법

1. 투표 페이지에서 다른 후보 선택
2. "Generate Proof" → "Submit" 클릭
3. 이전 투표는 자동으로 무효화되고 새 투표만 집계

### 중복 방지

- **같은 nullifier**: 같은 지갑 주소에서 생성된 nullifier는 중복으로 간주
- **블록체인 검증**: 스마트 컨트랙트에서 자동으로 중복 방지
- **마지막 표만 유효**: 컨트랙트 정책에 따라 마지막 투표만 저장

---

## 보안 및 익명성

### Zero-Knowledge Proof (ZKP)

- **완전한 익명성**: 서버도 투표 내용을 알 수 없음
- **수학적 보장**: Groth16 증명 시스템 사용
- **검증 가능**: Etherscan에서 증명 검증 가능

### 블록체인 투명성

- **불변성**: 투표 결과는 블록체인에 영구 저장
- **검증 가능**: 누구나 Etherscan에서 확인 가능
- **조작 불가능**: 블록체인 특성상 결과 조작 불가

### 개인정보 보호

- **지갑 주소만 사용**: 실제 신원 정보 불필요
- **Nullifier**: 중복 방지용 해시값 (원본 복원 불가)
- **Vote Commitment**: 암호화된 투표 내용 (원본 복원 불가)

---

## FAQ

### Q1: MetaMask가 없으면 투표할 수 없나요?

**A**: 네, MetaMask는 필수입니다. 투표 생성 및 참여 모두 MetaMask 지갑이 필요합니다.

### Q2: 가스비를 내야 하나요?

**A**: Relayer 기능이 활성화되어 있으면 가스비를 지불할 필요가 없습니다. Relayer가 자동으로 가스비를 대납합니다.

### Q3: 투표 내용을 누가 볼 수 있나요?

**A**:

- **투표 내용**: 아무도 볼 수 없습니다 (ZKP로 암호화)
- **투표 결과**: 모든 사람이 볼 수 있습니다 (블록체인 공개)
- **투표자 신원**: 알 수 없습니다 (완전한 익명성)

### Q4: 재투표는 어떻게 되나요?

**A**: 마감 시간 전까지 재투표가 가능하며, 마지막 투표만 유효합니다. 이전 투표는 자동으로 무효화됩니다.

### Q5: 투표를 삭제할 수 있나요?

**A**: 투표 생성자만 삭제할 수 있습니다. 삭제된 투표는 복구할 수 없으며, 모든 투표 데이터가 영구 삭제됩니다.

### Q6: ZKP 증명 생성이 너무 오래 걸려요

**A**:

- 정상적인 증명 생성 시간: 약 15초
- 타임아웃: 120초
- 느린 경우: 브라우저를 새로고침하고 다시 시도하세요
- WSL Proof 서버 사용 시: 3-6초로 단축 가능

### Q7: 투표 결과는 언제 확인할 수 있나요?

**A**:

- **진행 중**: "결과 보기" 버튼으로 실시간 결과 확인 가능
- **종료 후**: 자동으로 결과 표시
- **CSV 내보내기**: 언제든지 다운로드 가능

### Q8: 같은 사람이 여러 번 투표할 수 있나요?

**A**:

- **같은 지갑 주소**: 불가능 (중복 방지)
- **다른 지갑 주소**: 가능 (Open Poll 특성)
- **재투표**: 마감 전까지 가능 (마지막 표만 유효)

### Q9: Etherscan에서 무엇을 확인할 수 있나요?

**A**:

- **트랜잭션 해시**: 투표 제출 내역
- **이벤트 로그**: `VoteCast`, `ProofVerified` 이벤트
- **컨트랙트 코드**: Verifier 및 VotingV2 컨트랙트
- **블록 정보**: 투표가 포함된 블록 정보

### Q10: 투표가 실패하면 어떻게 되나요?

**A**:

- **증명 생성 실패**: 다시 "Generate Proof" 클릭
- **트랜잭션 실패**: Relayer가 자동으로 재시도 (최대 2회)
- **네트워크 오류**: 페이지 새로고침 후 다시 시도

---

## 기술 지원

### 문제 해결

- **투표 생성 실패**: MetaMask 연결 및 Sepolia 네트워크 확인
- **증명 생성 실패**: 브라우저 새로고침 후 재시도
- **트랜잭션 실패**: Relayer 잔액 확인 (관리자 문의)

### 추가 정보

- **아키텍처 문서**: [docs/ARCHITECTURE.md](../docs/ARCHITECTURE.md)
- **설계 문서**: [LIMITATIONS_AND_DESIGN.md](../LIMITATIONS_AND_DESIGN.md)
- **시작 가이드**: [START_PROJECT.md](../START_PROJECT.md)

---

**Made with ⚡ by VoteZK Team**
